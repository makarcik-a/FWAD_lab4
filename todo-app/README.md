# Лабораторная работа №2. HTTP-запросы и шаблонизация в Laravel

- [Лабораторная работа №2](#лабораторная-работа-2-http-запросы-и-шаблонизация-в-laravel)
    - [Задания](#задания)

## Задания
### №1. Подготовка к работе, установка Laravel

1. Откройте терминал и создайте новый проект Laravel с именем `todo-app` (имя проекта может быть любым) с помощью Composer:
   ```bash
   composer create-project laravel/laravel:^10 todo-app
   ```
2. Перейдите в директорию проекта:
   ```bash
   cd todo-app
   ```
3. Запустите встроенный сервер Laravel:
   ```bash
   php artisan serve
   ```
   **Вопрос**: Что вы видите в браузере, открыв страницу `http://localhost:8000`?
   
   **Ответ**: 
![image](https://github.com/user-attachments/assets/e1a868e1-d6d4-4441-9310-707252316e1a)


### №2. Настройка окружения

1. Откройте файл `.env` и укажите следующие настройки приложения:
   ```ini
   APP_NAME=ToDoApp
   APP_ENV=local
   APP_KEY=
   APP_DEBUG=true
   APP_URL=http://localhost:8000
   ```
![enмЫуеештпы](https://github.com/user-attachments/assets/8ff1d5da-eada-4c3e-bb57-d3d259a90cb5)

2. Сгенерируйте ключ приложения, который будет использоваться для шифрования данных:
   ```bash
   php artisan key:generate
   ```
   **Вопрос**: Что будет, если данный ключ попадет в руки злоумышленника?

   **Ответ**: Злоумышленник сможет расшифровать любые данные, зашифрованные с использованием этого ключа.

### №3. Основы работы с HTTP-запросами

#### №3.1. Создание маршрутов для главной страницы и страницы "О нас"

1. Создайте класс-контроллер `HomeController` для обработки запросов на главную страницу.
2. Добавьте метод `index` в `HomeController`, который будет отвечать за отображение главной страницы.

```php
class HomeController 
{
    public function index()
    {
        return view('home');
    }

    public function about()
    {
        return view('about');
    }
}
```
![controler](https://github.com/user-attachments/assets/49308153-13e4-4bcf-9553-45589392d575)

3. Создайте маршрут для главной страницы в файле `routes/web.php`.
   ```php
    Route::get('/', [HomeController::class, 'index'])->name('home');

    Route::get('/about', [HomeController::class, 'about'])->name('about');

   ```
   - Откройте браузер и перейдите по адресу `http://localhost:8000`. Убедитесь, что загружается пустая страница, так как представление home.blade.php пока не создано.
4. В этом же контроллере `HomeController` создайте метод для страницы **"О нас"**.
5. Добавьте маршрут для страницы "О нас" в файле `routes/web.php`.
![роуты](https://github.com/user-attachments/assets/a488f43e-48b3-4b74-8e8a-18c880c02908)


#### №3.2. Создание маршрутов для задач

1. Создайте класс-контроллер `TaskController` для обработки запросов, связанных с задачами, и добавьте следующие методы:
   - `index` — отображение списка задач;
   - `create` — отображение формы создания задачи;
   - `store` — сохранение новой задачи;
   - `show` — отображение задачи;
   - `edit` — отображение формы редактирования задачи;
   - `update` — обновление задачи;
   - `destroy` — удаление задачи.

   **Примечание:** _Пока мы не изучили работу с формами и запросами POST и PUT, методы `store`, `create`, `edit`, `update`, `destroy` оставьте пустыми. Мы вернемся к ним позже в курсе. В данный момент сосредоточимся на отображении информации._

   Пример метода `index`:
   ```php
   public function index()
   {
       return 'This is a list of tasks';
   }
   ```

2. Создайте маршруты для методов контроллера `TaskController` в файле `routes/web.php` и укажите правильные HTTP-методы для каждого маршрута.
3. Используйте группирование маршрутов для контроллера `TaskController` с префиксом `/tasks`, чтобы упростить маршрутизацию и улучшить читаемость кода.
4. Определите правильные имена маршрутов для методов контроллера `TaskController`, например:
   - `tasks.index` — список задач;
   - `tasks.show` — отображение отдельной задачи.
   - ...
5. Добавьте валидацию параметров маршрута `id` для задач. Убедитесь, что параметр `id` — это положительное целое число. Используйте метод `where`, чтобы ограничить значения для параметра `id`.

```php
Route::prefix('tasks')->group(function () {
    Route::get('/', [TaskController::class, 'index'])->name('tasks.index');
    Route::get('/create', [TaskController::class, 'create'])->name('tasks.create');
    Route::post('/', [TaskController::class, 'store'])->name('tasks.store');
    Route::get('/{id}', [TaskController::class, 'show'])->name('tasks.show')->where('id', '[0-9]+');
    Route::get('/{id}/edit', [TaskController::class, 'edit'])->name('tasks.edit')->where('id', '[0-9]+');
    Route::put('/{id}', [TaskController::class, 'update'])->name('tasks.update')->where('id', '[0-9]+');
    Route::delete('/{id}', [TaskController::class, 'destroy'])->name('tasks.destroy')->where('id', '[0-9]+');
});
```

6. Вместо ручного создания маршрутов для каждого метода можно использовать **ресурсный контроллер**, который автоматически создаст маршруты для всех **CRUD-операций**:
   - В файле `routes/web.php` замените ручное создание маршрутов для контроллера `TaskController` на ресурсный контроллер:
      ```php
      Route::resource('tasks', TaskController::class);
      ```
   - **Вопрос**: Объясните разницу между ручным созданием маршрутов и использованием ресурсного контроллера. Какие маршруты и имена маршрутов будут созданы автоматически?

    
   **Ручное создание маршрутов**: Явно определяем каждый маршрут в файле. Это дает нам полный контроль над URL, HTTP-методами и именами маршрутов.

   **Использование ресурсного контроллера**: Ресурсный контроллер позволяет автоматически создать набор маршрутов для стандартных операций CRUD (Create, Read, Update, Delete). Это упрощает код и уменьшает вероятность ошибок.


7. Проверьте созданные маршруты с помощью команды `php artisan route:list`.

```http
 GET|HEAD        / .................................................................................................................................................................................................................... home › HomeController@index  
  GET|HEAD        about ............................................................................................................................................................................................................... about › HomeController@about  
  GET|HEAD        api/user .........................................................................................................................................................................................................................................  
  GET|HEAD        tasks ......................................................................................................................................................................................................... tasks.index › TaskController@index  
  POST            tasks ......................................................................................................................................................................................................... tasks.store › TaskController@store  
  GET|HEAD        tasks/create ................................................................................................................................................................................................ tasks.create › TaskController@create  
  GET|HEAD        tasks/{task} .................................................................................................................................................................................................... tasks.show › TaskController@show  
  PUT|PATCH       tasks/{task} ................................................................................................................................................................................................ tasks.update › TaskController@update  
  DELETE          tasks/{task} .............................................................................................................................................................................................. tasks.destroy › TaskController@destroy  
  GET|HEAD        tasks/{task}/edit ............................................................................................................................................................................................... tasks.edit › TaskController@edit 
  ```

### №4. Шаблонизация с использованием Blade

#### №4.1. Создание макета страницы

1. Создайте макет основных страниц `layouts/app.blade.php` с общими элементами страницы:
   1. Заголовок страницы;
   2. Меню навигации;
   3. Контент страницы.
2. Используйте директиву `@yield` для определения области, в которую будут вставляться содержимое различных страниц.

#### №4.2. Использование шаблонов Blade

1. Создайте представление для главной страницы `home.blade.php` с использованием макета `layouts/app.blade.php` в каталоге `resources/views`.
2. На главной странице должно быть:
   1. **Приветственное сообщение**: заголовок и краткое описание приложения, например "To-Do App для команд".
   2. **Навигация**: ссылки на основные разделы, такие как:
      - Список задач;
      - Создание задачи.
   3. **Информация о приложении**: краткое описание назначения приложения и его основных функций.
3. Создайте представление для страницы "О нас" — `about.blade.php` с использованием макета `layouts/app.blade.php` в каталоге `resources/views`.
4. Создайте представления для задач со следующими шаблонами в каталоге `resources/views/tasks`:
   - `index.blade.php` — список задач;
   - `show.blade.php` — отображение задачи;
   - ...
5. Отрендерите список задач на странице `index.blade.php` с использованием статических данных, передаваемых из контроллера с помощью директивы `@foreach`.

**Примечание**: Поскольку мы пока не работаем с базой данных и моделями, используйте статические данные, передаваемые из контроллера в шаблон, для отображения информации о задачах. Логика обработки данных пока не требуется.

Пример метода для отображения задачи:
```php
public function show($id)
{
    $task = [
        'id' => $id,
        'title' => 'Task Title',
        // ...
    ];

    return view('tasks.show', ['task' => $task]);
}
```

#### №4.3. Анонимные компоненты Blade

> [!TIP]
> В Laravel можно создавать анонимные компоненты для упрощения структуры шаблонов и многократного использования блоков кода.

1. Создайте анонимный компонент для отображения `header`. Используйте созданный компонент в макете `layouts/app.blade.php`.
2. Создайте анонимный компонент для отображения задачи:
   1. Компонент должен быть простым и использовать передаваемые параметры с помощью директивы `@props`. Это сделает шаблоны более гибкими и переиспользуемыми на различных страницах.
   2. Компонент должен отображать информацию о задаче:
      1. Название задачи;
      2. Описание задачи;
      3. Дата создания задачи;
      4. Дата обновления задачи;
      5. Действия над задачей (редактирование, удаление);
      6. Статус задачи (выполнена/не выполнена);
      7. Приоритет задачи (низкий/средний/высокий);
      8. Исполнитель задачи (Assignment), то есть имя пользователя, которому назначена задача.
3. Отобразите созданный компонент задачи на странице `show.blade.php` с использованием передаваемых параметров.

#### №4.4. Стилизация страниц

1. Добавьте стили для страниц с использованием CSS или препроцессоров (например, Sass или Less).
2. Создайте файл стилей `app.css` в каталоге `public/css` и подключите его к макету `layouts/app.blade.php`.
3. Добавьте стили для элементов страницы, таких как заголовки, меню навигации, кнопки, формы и т. д.
4. При желании можно использовать библиотеки стилей, такие как `Bootstrap` или `Tailwind CSS`.

### №5. Дополнительные задания

> [!IMPORTANT]
> Данное задание не является обязательным, но позволит углубить понимание материала.

1. Отобразите последнюю созданную задачу на главной странице с использованием **View Composer**.
2. Создайте дополнительный анонимный компонент для отображения приоритета задачи (низкий, средний, высокий) с разными цветами или иконками для каждого приоритета.

## Контрольные вопросы

1. Что такое ресурсный контроллер в Laravel и какие маршруты он создает?

Ответ: Ресурсный контроллер - это контроллер, который автоматически создает набор маршрутов для выполнения операций CRUD (Create, Read, Update, Delete)

2. Объясните разницу между ручным созданием маршрутов и использованием ресурсного контроллера.

Ручное создание маршрутов:

Требует явного определения каждого маршрута в файле маршрутов.
Позволяет гибко настраивать маршруты и методы контроллеров.
Подходит для случаев, когда требуется нестандартное поведение или дополнительные маршруты.

Использование ресурсного контроллера:

Автоматически создает стандартные маршруты для операций CRUD.
Упрощает управление маршрутами и контроллерами.
Подходит для стандартных операций CRUD, где не требуется дополнительная настройка маршрутов.

3. Какие преимущества предоставляет использование анонимных компонентов Blade?

   1. Упрощение кода: Анонимные компоненты позволяют создавать повторно используемые части интерфейса без необходимости создания отдельных классов компонентов.
   2. Инкапсуляция: Компоненты инкапсулируют логику и представление, что делает код более модульным и поддерживаемым.
   3. Гибкость: Анонимные компоненты могут принимать параметры и слоты, что делает их гибкими и легко настраиваемыми.
   4. Чистота шаблонов: Использование компонентов делает шаблоны Blade чище и понятнее, так как сложная логика и разметка выносятся в отдельные файлы компонентов.

4. Какие методы HTTP-запросов используются для выполнения операций **CRUD**?
   1. Create (Создание): POST
   2. Read (Чтение): GET
   3. Update (Обновление): PUT или PATCH
   4. Delete (Удаление): DELETE
![home](https://github.com/user-attachments/assets/9f377ad8-73f2-4d64-beb8-23bd1aea6edf)
